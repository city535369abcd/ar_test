<!DOCTYPE html>
<html>

<head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/ar.js@1.7.2/aframe/build/aframe-ar.min.js"></script>

    <script>
        AFRAME.registerComponent('toggle-animation', {
            init: function () {
                var el = this.el;
                var mixer;
                var isPlaying = false; // 初始狀態為停止

                el.addEventListener('model-loaded', function () {
                    // 確保模型加載完成後取得動畫
                    mixer = el.getObject3D('mesh').mixer;
                });

                function toggleAnimation() {
                    if (!mixer) return; // 確保動畫混合器存在

                    if (isPlaying) {
                        mixer.timeScale = 0; // 停止動畫
                    } else {
                        mixer.timeScale = 1; // 播放動畫
                    }
                    isPlaying = !isPlaying; // 切換狀態
                }

                // 電腦點擊
                el.addEventListener('click', toggleAnimation);

                // 手機觸控
                el.addEventListener('touchstart', function (event) {
                    event.preventDefault(); // 避免手機預設行為（如縮放）
                    toggleAnimation();
                }, { passive: false });
            }
        });
    </script>
</head>

<body style="margin: 0px; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- Hiro 標記 -->
        <a-marker preset="hiro">
            <a-entity 
                gltf-model="atack.glb" 
                position="0 0 0"
                scale="1 1 1"
                animation-mixer
                toggle-animation>
            </a-entity>
        </a-marker>

        <!-- 相機 -->
        <a-entity camera></a-entity>
    </a-scene>
</body>

</html>
